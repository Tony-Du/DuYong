<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
						"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.migu.cpa.mapper.EventOccurMapper">

	<resultMap id="BaseResultMap" type="com.migu.cpa.domain.EventOccurInfo">
		<result column="src_file_day" property="date" />
		<result column="event_cnt" property="count"></result>
		<result column="sum_du" property="sumDu"></result>
		<result column="avg_du" property="avgDu"></result>
	</resultMap>

	<sql id="Base_Column_List">
		src_file_day,event_cnt,sum_du,avg_du
	</sql>
	
	<!-- 查询当前时间的事件信息 -->
	<select id="findEventInfoDay" parameterType="Object" resultMap="BaseResultMap">
		select  <include refid="Base_Column_List" /> from cpa_event_occur_daily
		<where>
		    src_file_day=#{0} and
		     product_key = #{1} and
		     app_ver_code = #{2} and
		     app_channel_id = #{3} and
		     event_name = #{4}
		</where>
	</select>

    <!-- 查询过去7天或者过去30天事件信息 -->
	<select id="findEventInfoPast" parameterType="Object" resultMap="BaseResultMap">
		select  <include refid="Base_Column_List" /> from cpa_event_occur_daily
		<where>
			    src_file_day <![CDATA[ >= ]]> #{0} and
			    src_file_day <![CDATA[ <= ]]> #{1} and
			    product_key = #{2} and
			    app_ver_code = #{3} and
			    app_channel_id  = #{4}  and
			    event_name = #{5}
		</where>
	</select>

</mapper>