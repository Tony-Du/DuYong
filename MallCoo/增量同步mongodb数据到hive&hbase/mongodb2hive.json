{
    "job": {
        "content": [
            {
                "reader": {
                    "name": "mongodbreader", 
                    "parameter": {
                        "collectionName": "AAA", 
                        "column": [ 
                          {
                              "name": "mac"
                          },
                          {
                              "name": "date"
                          },
                          {
                              "name": "CreateTime"
                          },
                          {
                              "name": "MallID"
                          },
                          {
                              "name": "ShopID"
                          },
                          {
                              "name": "retentiontime"
                          },
                          {
                              "name": "in"
                          },
                          {
                              "name": "out"
                          }
                        ], 
                        "dbName": "MallcooStatistics",
                        "userName": "", 
                        "userPassword": "",
                        "url":"mongodb://muser:1qaz2wsx@test:27017/?authSource=admin",
                        "query":"{'date':{$lte:ISODate('${query}T16:00:00Z')}}"
                    }
                }, 
                "writer": {
                    "name": "hdfswriter", 
                    "parameter": {
                        "column": [
                          {
                              "name": "mac",
                              "type": "string"
                          },
                          {
                              "name": "date",
                              "type": "string"
                          },
                          {
                              "name": "CreateTime",
                              "type": "string"
                          },
                          {
                              "name": "MallID",
                              "type": "string"
                          },
                          {
                              "name": "ShopID",
                              "type": "string"
                          },
                          {
                              "name": "retentiontime",
                              "type": "string"
                          },
                          {
                              "name": "in",
                              "type": "string"
                          },
                          {
                              "name": "out",
                              "type": "string"
                          }
                        ], 
                        "defaultFS": "hdfs://thahadoop001:9000", 
                        "fieldDelimiter": "\1", 
                        "fileName": "mongo2hive", 
                        "fileType": "orc", 
                        "path": "${path}", 
                        "writeMode": "append"
                    }
                }
            }
        ], 
        "setting": {
            "speed": {
                "channel": 4
            }
        }
    }
}




