




1. 阿里口碑洞察   SQL
201801-02

(1)目的：为适应客户端产品的发展，和阿里巴巴口碑实验室合作，获取其口碑相关的数据
(2)指标：
1).综合体用户累计消费数据汇总表 
user_id 进行了加密;
综合体
小时粒度(1~24) 

180 天
重新按biz_dat(消费时间)进行分组

2).综合体下门店的评论明细表，
综合体门店，
评论时间、评论内容、评论星数

180 天
重新按comment_time(消费时间)进行分组


3).综合体人群分布热力图表
综合体的经纬度和名称，消费者工作或住宅的经纬度和名称

360天


2. 探针统计逻辑 MR/java
201712
1）拿到一个用户在一天内被探针扫描到的所有记录(即行为记录：person_mac,time_scan,probe_mac,rssi_scan,mallid,shopid...)  

2）job1: 确定用户在哪个店铺;
现在有这样的问题： 一个用户在某个店铺中，不仅被该店铺扫描到，可能被其他店铺扫描到
前一条记录（referedData） 与 当前记录比较：
shopid是否相同？
	|
    |-  相同，表示还在同一个店铺，把当前记录放到newlist，后面计算停留时间需要使用；并改变被比较的变量（referedData）
	|
	|-  不相同，实际可能有两种情况：还在该店铺但是被别的店铺的探针扫描到 或者 确实是在别的店铺；
	    所以要进行场强的判断？
            |
            |-  前一条记录的场强 比 当前记录的场强 大很多(大于等于某个阈值)， 则是前者 还在该店铺但是被别的店铺的探针扫描到，不记录该记录,不改变被比较的变量（referedData）
            |
            |-- 前一条记录的场强 比 当前记录的场强 大不了多少（小于等于某个阈值），此时无法判断
			    所以需要看看后面60条记录的shopid 哪个出现的最多？
				     |
				     |--  如果出现 最多的shopid 包含 当前记录的shopid， 则确实是在别的店铺,把当前记录放到newlist，不改变被比较的变量（referedData）
				     |
                     |--  如果出现 最多的shopid 包含 前一条记录的shopid， 则是前者 还在该店铺
					 
					 
new_list:
mac	shopid	rssi
001	00A		60
001	00A		70
001	00A		80
...
001	00B		50
001	00B		80
...



3）Job2:计算该用户所待店铺的停留时长

前一条记录 与 当前记录比较：

shopid相同，有两种情况:一直在同一个店铺，或者二次进店
  |
  |-- 判断时否为二次进店，以时间间隔1h为阈值
            是，则统计前一条记录的停留时间（注意过滤掉停留时间小于0.5min的），当前记录 进行下一轮的比较
            否，还停留在前一条记录，当前记录的时间作为 离开时间
         
shopid不相同，表示不在同一个店铺   
  |
  |-- 则统计前一条记录的停留时间（注意过滤掉停留时间小于0.5min的），当前记录 进行下一轮的比较




3. 关联分析
201711

4. dataX 同步数据
201711

mongo--->hive    只能全量同步，无法增量同步。  处理方法：修改源码
mongo--->hbase   null值会出现问题。修改源码，过滤掉NULL值的字段  

时间需要 使用 dataX_groovy 进行处理成 合理的格式


5.
201709
增加口碑数据来源 （不重要）


6.辐射范围
地球两点间距离计算 UDF

201710



8.漏斗分析算法
201802

9.微信净关注数 数据问题
201801



























