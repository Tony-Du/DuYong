{
    "job": {
        "content": [{
            "reader": {
                "name": "mallcoo_mongodbreader",
                "parameter": {
                    "collectionName": "PutInChannel",
                    "column": [
                        { "index": 0,  "name": "_id", "type": "long" },
                        { "index": 1,  "name": "ChannelNo", "type": "string" },
                        { "index": 2,  "name": "Name", "type": "string" },
                        { "index": 3,  "name": "Desc", "type": "string" },
                        { "index": 4,  "name": "CreateID", "type": "long" },
                        { "index": 5,  "name": "CreateName", "type": "string" },
                        { "index": 6,  "name": "CreateTime", "type": "date" },
                        { "index": 7,  "name": "UpdateID", "type": "long" },        
                        { "index": 8,  "name": "UpdateName", "type": "string" },
                        { "index": 9,  "name": "UpdateTime", "type": "date" },
                        { "index": 10, "name": "State", "type": "int" },                        
                        { "index": 11, "name": "ChannelEnumValue", "type": "int" }       
                    ],
                    "dbName": "Coupon",
                    "url": "$url/Coupon.PutInChannel$qs"
                }
            },
            "writer": {
                "name": "hbase11xwriter",
                "parameter": {
                    "column": [
                        { "index": 1,  "name": "data:ChannelNo", "type": "LONG" },
                        { "index": 2,  "name": "data:Name", "type": "string" },
                        { "index": 3,  "name": "data:Desc", "type": "string" },
                        { "index": 4,  "name": "data:CreateID", "type": "LONG" },
                        { "index": 5,  "name": "data:CreateName", "type": "string" },
                        { "index": 6,  "name": "data:CreateTime", "type": "string" },
                        { "index": 7,  "name": "data:UpdateID", "type": "LONG" },       
                        { "index": 8,  "name": "data:UpdateName", "type": "string" },
                        { "index": 9,  "name": "data:UpdateTime", "type": "string" },
                        { "index": 10, "name": "data:State", "type": "int" },                       
                        { "index": 11, "name": "data:ChannelEnumValue", "type": "int" }            
                    ],
                    "encoding": "utf-8", 
                    "hbaseConfig": {
                        "hbase.cluster.distributed": "true", 
                        "hbase.rootdir": "hdfs://hadoop000:9000/hbase", 
                        "hbase.zookeeper.quorum": "hadoop000,hadoop004,hadoop005"
                    }, 
                    "mode": "normal", 
                    "rowkeyColumn": [{ "index":0, "type":"LONG"}], 
                    "table": "put_in_channel"
                }
            },
            "transformer": [
                { "name": "dx_groovy",
                  "parameter": { "code": "SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");
                                          record.setColumn(6, new StringColumn(sdf.format(record.getColumn(6).asDate())));
                                          record.setColumn(9, new StringColumn(sdf.format(record.getColumn(9).asDate())));
                                          return record;",                                            
                                 "extraPackage":[ "import java.text.SimpleDateFormat;" ] 
                               }                                 
                }
            ]
        }],
        "setting": { "speed": { "channel": $channel } }
    }
}
