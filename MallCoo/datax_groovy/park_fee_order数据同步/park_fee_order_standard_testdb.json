{
    "job": {
        "content": [{
            "reader": {
                "name": "mongodbreader", 
                "parameter": {
                    "collectionName": "ParkFeeOrder",                                                    
                    "column": [                                                 
                        { "name": "_id", "type":"string"},                                       
                        { "name": "Flag" },                                     
                        { "name": "OrderNo" },                                  
                        { "name": "UID" },                                      
                        { "name": "ParkName" },                                 
                        { "name": "PlateNo" },                                  
                        { "name": "EntryTime" },                                
                        { "name": "LeaveTime" },                
                        { "name": "ParkingMinutes" },                           
                        { "name": "PayType" },                                  
                        { "name": "Bonus" },                                    
                        { "name": "BonusAmountOffset"},                         
                        { "name": "ParkingTotalFee" },                          
                        { "name": "MallID" },                                   
                        { "name": "ParkingFee" },                               
                        { "name": "CreateTime" },                
                        { "name": "OrderStatus" },                              
                        { "name": "MallTimeOffset" },                           
                        { "name": "MallAmountOffset" },                         
                        { "name": "MemberRightAmountOffset" },                  
                        { "name": "MemberRightTimeOffset" },                    
                        { "name": "CouponTimeOffset" },                         
                        { "name": "CouponAmountOffset" },                       
                        { "name": "OrderPrice" },
                        { "name": "FeeID" }   
                    ],                                                          
                    "dbName": "SP_Park",                                        
                    "url":"mongodb://sp1:28001,sp2:28001/SP_Park.ParkFeeOrder", 
                    "query":"{'_id':{ $gte:1,$lte:100 }}"             
                }                                                               
            },                                                                  
            "writer": {                                                         
                "name": "hdfswriter",                                           
                "parameter": {                                                  
                    "column": [                                                 
                        { "name": "id", "type":"string" },                      
                        { "name": "Flag", "type":"string" },                                        
                        { "name": "OrderNo", "type":"string" },                                     
                        { "name": "UID", "type":"bigint" },                                         
                        { "name": "ParkName", "type":"string" },
                        { "name": "PlateNo", "type":"string" },                        
                        { "name": "EntryTime", "type":"string" },
                        { "name": "LeaveTime", "type":"timestamp" },
                        { "name": "ParkingMinutes", "type":"double" },
                        { "name": "PayType", "type":"double" },
                        { "name": "Bonus", "type":"double" },                      
                        { "name": "BonusAmountOffset", "type":"double" },
                        { "name": "ParkingTotalFee", "type":"double" },
                        { "name": "MallID", "type":"bigint" },
                        { "name": "ParkingFee", "type":"double" },
                        { "name": "CreateTime", "type":"timestamp" },                        
                        { "name": "Status", "type":"double" },
                        { "name": "MallTimeOffset", "type":"double" },
                        { "name": "MallAmountOffset", "type":"double" },
                        { "name": "MemberRightAmountOffset", "type":"double" },
                        { "name": "MemberRightTimeOffset", "type":"double" },                       
                        { "name": "CouponTimeOffset", "type":"double" },                        
                        { "name": "CouponAmountOffset", "type":"double" },
                        { "name": "OrderPrice", "type":"double" },
                        { "name": "FeeID", "type":"string" }            
                    ], 
                    "defaultFS": "hdfs://thahadoop001:8020", 
                    "fieldDelimiter": "\1",
                    "fileName": "test",
                    "fileType": "orc",
                    "path": "/user/hive/warehouse/test.db/park_fee_order_t",
                    "writeMode": "append"
                }
            },
            "transformer": [{ 
                  "name": "dx_groovy",
                  "parameter": { "code": "record.setColumn(1, new StringColumn(\"program\")); BigDecimal bg = new BigDecimal(record.getColumn(11).asDouble()/100); double bao_v = bg.setScale(4,BigDecimal.ROUND_HALF_UP).doubleValue(); record.setColumn(11, new DoubleColumn(bao_v)); record.setColumn(14, new DoubleColumn(record.getColumn(14).asDouble()/100)); return record;",
								 "extraPackage":[ "import java.math.BigDecimal;" ]  
                               }                                                          
                }]
        }], 
        "setting": { "speed": { "channel": 4 } }
    }
}  