{
    "job": {
        "content": [{
            "reader": {
                "name": "mongodbreader",                                                                                    
                "parameter": {                                                                                              
                    "collectionName": "ParkFeeOrder",                                                                       
                    "column": [                                                                                             
                        { "name": "_id", "type":"bigint" },                      
                        { "name": "Flag", "type":"string" },                                        
                        { "name": "OrderNo", "type":"string" },                                     
                        { "name": "UID", "type":"string" },                                         
                        { "name": "ParkName", "type":"string" },
                        { "name": "PlateNo", "type":"string" },     
                        { "name": "EntryTime", "type":"string" },
                        { "name": "LeaveTime", "type":"timestamp" },
                        { "name": "ParkingMinutes", "type":"int" },
                        { "name": "PayType", "type":"int" },
                        { "name": "Bonus", "type":"double" },                      
                        { "name": "BonusAmountOffset", "type":"double" },
                        { "name": "ParkingTotalFee", "type":"double" },
                        { "name": "MallID", "type":"string" },
                        { "name": "ParkingFee", "type":"double" },
                        { "name": "CreateTime", "type":"timestamp" },                        
                        { "name": "Status", "type":"int" },
                        { "name": "MallTimeOffset", "type":"double" },
                        { "name": "MallAmountOffset", "type":"double" },
                        { "name": "MemberRightAmountOffset", "type":"double" },
                        { "name": "MemberRightTimeOffset", "type":"double" },                       
                        { "name": "CouponTimeOffset", "type":"double" },                        
                        { "name": "CouponAmountOffset", "type":"double" },
                        { "name": "OrderPrice", "type":"double" },
                        { "name": "FeeID", "type":"string" }                    
                    ],                                                                                                      
                    "dbName": "MallCoo",                                                                                    
                    "url":"mongodb://mallcoo1:27018,mallcoo2:27081/MallCoo.ParkFeeOrder",                                   
                    "query":"{'_id':{ $gt:$start,$lte:$end }}"                                                              
                }                                                                                                           
            },                                                                                                              
            "writer": {                                                                                                     
                "name": "hdfswriter",                                                                                       
                "parameter": {                                                                                              
                    "column": [                                                                                             
                        { "name": "id", "type":"bigint" },                      
                        { "name": "Flag", "type":"string" },                                        
                        { "name": "OrderNo", "type":"string" },                                     
                        { "name": "UID", "type":"string" },                                         
                        { "name": "ParkName", "type":"string" },
                        { "name": "PlateNo", "type":"string" },     
                        { "name": "EntryTime", "type":"string" },
                        { "name": "LeaveTime", "type":"timestamp" },
                        { "name": "ParkingMinutes", "type":"int" },
                        { "name": "PayType", "type":"int" },
                        { "name": "Bonus", "type":"double" },                      
                        { "name": "BonusAmountOffset", "type":"double" },
                        { "name": "ParkingTotalFee", "type":"double" },
                        { "name": "MallID", "type":"string" },
                        { "name": "ParkingFee", "type":"double" },
                        { "name": "CreateTime", "type":"timestamp" },                        
                        { "name": "Status", "type":"int" },
                        { "name": "MallTimeOffset", "type":"double" },
                        { "name": "MallAmountOffset", "type":"double" },
                        { "name": "MemberRightAmountOffset", "type":"double" },
                        { "name": "MemberRightTimeOffset", "type":"double" },                       
                        { "name": "CouponTimeOffset", "type":"double" },                        
                        { "name": "CouponAmountOffset", "type":"double" },
                        { "name": "OrderPrice", "type":"double" },
                        { "name": "FeeID", "type":"string" }    
                    ], 
                    "defaultFS": "hdfs://hadoop000:9000",
                    "fieldDelimiter": "\1",
                    "fileName": "$filename",
                    "fileType": "orc",
                    "path": "/user/root/hive/online.db/parkfeeorder",
                    "writeMode": "append"
                }
            },
            "transformer": [
                { "name": "dx_groovy",
                  "parameter": { "code": "record.setColumn(1, new StringColumn(\"program\"));" }                                   
                }
            ]
        }], 
        "setting": { "speed": { "channel": 4 } }
    }
}  
