{
    "job": {
        "content": [
            {
                "reader": {
                    "name": "mongodbreader", 
                    "parameter": {
                        "collectionName": "MemberTag", 
                        "column": [
                          { "index": 0, "name": "_id", "type": "string"  },
                          { "index": 1, "name": "MallID", "type": "string"  },
                          { "index": 2, "name": "TagName", "type": "string"  },
                          { "index": 3, "name": "Content", "type": "string"  },
                          { "index": 4, "name": "CreatorID", "type": "string"  },
                          { "index": 5, "name": "Creator", "type": "string"  },
                          { "index": 6, "name": "UpdatorID", "type": "string"  },
                          { "index": 7, "name": "Updator", "type": "string"  },
                          { "index": 8, "name": "CreateTime", "type": "Date"  },
                          { "index": 9, "name": "UpdateTime", "type": "Date"  },
                          { "index": 10, "name": "IsDel", "type": "boolean" }
                        ], 
                        "dbName": "SP_UserCenter", 
                        "url":"$url/SP_UserCenter.MemberTag$qs",
                        "query":"{'UpdateTime':{$gte:ISODate($start),$lt:ISODate($end)}}"
                    }
                }, 
                "writer": {
                    "name": "hbase11xwriter", 
                    "parameter": {
                        "column": [
                          { "index": 1, "name": "data:mallid", "type": "string" },
                          { "index": 2, "name": "data:tagname", "type": "string" },
                          { "index": 3, "name": "data:content", "type": "string" },
                          { "index": 4, "name": "data:creatorid", "type": "string" },
                          { "index": 5, "name": "data:creator", "type": "string" },
                          { "index": 6, "name": "data:updatorid", "type": "string" },
                          { "index": 7, "name": "data:updator", "type": "string" },
                          { "index": 8, "name": "data:createtime", "type": "string" },
                          { "index": 9, "name": "data:updatetime", "type": "string" },
                          { "index": 10, "name": "data:isdel", "type": "boolean" }
                        ], 
                        "encoding": "utf-8", 
                        "hbaseConfig": {
                            "hbase.cluster.distributed": "true", 
                            "hbase.rootdir": "hdfs://hadoop000:9000/hbase", 
                            "hbase.zookeeper.quorum": "hadoop000,hadoop004,hadoop005"
                        }, 
                        "mode": "normal", 
                        "rowkeyColumn": [{ "index":0, "type":"string"}], 
                        "table": "member_tag", 
                    }
                },
                "transformer": [
                    { "name": "dx_groovy",
                      "parameter": { "code": "SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");
                                              String create_time = sdf.format(record.getColumn(8).asDate());
                                              String update_time = sdf.format(record.getColumn(9).asDate());
                                              record.setColumn(8, new StringColumn(create_time));
                                              record.setColumn(9, new StringColumn(update_time));
                                              return record;",                                            
                                     "extraPackage":[ "import java.text.SimpleDateFormat;" ] 
                                   }                                 
                    }
                ]
            }
        ], 
        "setting": {
            "speed": {
                "channel": 4
            }
        }
    }
}
