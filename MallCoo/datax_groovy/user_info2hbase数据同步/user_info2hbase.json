{
    "job": {
        "content": [
            {
                "reader": {
                    "name": "mongodbreader", 
                    "parameter": {
                        "collectionName": "UserInfo", 
                        "column": [
                          { "index": 0, "name": "_id", "type": "string" },                               
                          { "index": 1, "name": "UID", "type": "string" },                               
                          { "index": 2, "name": "UserName", "type": "string" },                          
                          { "index": 3, "name": "Gender", "type": "string" },                            
                          { "index": 4, "name": "Age", "type": "string" },                               
                          { "index": 5, "name": "Birthday", "type": "string" },                          
                          { "index": 6, "name": "IDNum", "type": "string" },                             
                          { "index": 7, "name": "Email", "type": "string" },                             
                          { "index": 8, "name": "Education", "type": "string" },                         
                          { "index": 9, "name": "Marital", "type": "string" },                           
                          { "index": 10, "name": "HasChildren", "type": "string" },                       
                          { "index": 11, "name": "ChildrenCount", "type": "string" },                    
                          { "index": 12, "name": "ProvinceID", "type": "string" },                       
                          { "index": 13, "name": "Province", "type": "string" },                         
                          { "index": 14, "name": "CityID", "type": "string" },                           
                          { "index": 15, "name": "City", "type": "string" },                             
                          { "index": 16, "name": "DistrictsID", "type": "string" },                      
                          { "index": 17, "name": "Districts", "type": "string" },                        
                          { "index": 18, "name": "ProvincialAreas", "type": "string" },                  
                          { "index": 19, "name": "Address", "type": "string" },                          
                          { "index": 20, "name": "Business", "type": "string" },                         
                          { "index": 21, "name": "Income", "type": "string" },                           
                          { "index": 22, "name": "Conveyance", "type": "string" },                        
                          { "index": 23, "name": "Wechat", "type": "string" },                           
                          { "index": 24, "name": "Reference", "type": "string" },                        
                          { "index": 25, "name": "InviteCode", "type": "string" },                       
                          { "index": 26, "name": "HobbyList", "type": "Array", "splitter": "_" },                        
                          { "index": 27, "name": "ThirdCardNo", "type": "string" },                      
                          { "index": 28, "name": "IsPostal", "type": "string" },                         
                          { "index": 29, "name": "FocusInfoList", "type": "Array", "splitter": "_" },                    
                          { "index": 30, "name": "AcceptInfoTypeList", "type": "Array", "splitter": "_" },               
                          { "index": 31, "name": "ShoppingInterestList", "type": "Array", "splitter": "_" },             
                          { "index": 32, "name": "ActiveInterestList", "type": "Array", "splitter": "_" },               
                          { "index": 33, "name": "CarNO", "type": "string" },                             
                          { "index": 34, "name": "Remark1", "type": "string" },                           
                          { "index": 35, "name": "Remark2", "type": "string" },                           
                          { "index": 36, "name": "Remark3", "type": "string" },                           
                          { "index": 37, "name": "Remark4", "type": "string" },                           
                          { "index": 38, "name": "Remark5", "type": "string" },                           
                          { "index": 39, "name": "Remark6", "type": "string" },                           
                          { "index": 40, "name": "Remark7", "type": "string" },                           
                          { "index": 41, "name": "Remark8", "type": "string" },                           
                          { "index": 42, "name": "Remark9", "type": "string" },                           
                          { "index": 43, "name": "Remark10", "type": "string" },                          
                          { "index": 44, "name": "Remark11", "type": "string" },                          
                          { "index": 45, "name": "Remark12", "type": "string" },                          
                          { "index": 46, "name": "Remark13", "type": "string" },                          
                          { "index": 47, "name": "Remark14", "type": "string" },                          
                          { "index": 48, "name": "Remark15", "type": "string" },                          
                          { "index": 49, "name": "Remark16", "type": "string" },                          
                          { "index": 50, "name": "Remark17", "type": "string" },                          
                          { "index": 51, "name": "Remark18", "type": "string" },                          
                          { "index": 52, "name": "Remark19", "type": "string" },                          
                          { "index": 53, "name": "Remark20", "type": "string" },                          
                          { "index": 54, "name": "MemberTagIDList", "type": "Array", "splitter": "_" }, 
                          { "index": 55, "name": "CreateTime", "type": "Date" },                       
                          { "index": 56, "name": "UpdateTime", "type": "Date" },                       
                          { "index": 57, "name": "Status", "type": "string" }                             
                        ], 
                        "dbName": "SP_UserCenter", 
                        "url":"$url/SP_UserCenter.UserInfo$qs",
                        "query":"{'UpdateTime':{$gte:ISODate($start),$lt:ISODate($end)}}"
                    }
                }, 
                "writer": {
                    "name": "hbase11xwriter", 
                    "parameter": {
                        "column": [                             
                          { "index": 1, "name": "cf1:UID", "type": "string" },                               
                          { "index": 2, "name": "cf1:UserName", "type": "string" },                          
                          { "index": 3, "name": "cf1:Gender", "type": "string" },                            
                          { "index": 4, "name": "cf1:Age", "type": "string" },                               
                          { "index": 5, "name": "cf1:Birthday", "type": "string" },                          
                          { "index": 6, "name": "cf1:IDNum", "type": "string" },                             
                          { "index": 7, "name": "cf1:Email", "type": "string" },                             
                          { "index": 8, "name": "cf1:Education", "type": "string" },                         
                          { "index": 9, "name": "cf1:Marital", "type": "string" },                           
                          { "index": 10, "name": "cf1:HasChildren", "type": "string" },                       
                          { "index": 11, "name": "cf1:ChildrenCount", "type": "string" },                    
                          { "index": 12, "name": "cf1:ProvinceID", "type": "string" },                       
                          { "index": 13, "name": "cf1:Province", "type": "string" },                         
                          { "index": 14, "name": "cf1:CityID", "type": "string" },                           
                          { "index": 15, "name": "cf1:City", "type": "string" },                             
                          { "index": 16, "name": "cf1:DistrictsID", "type": "string" },                      
                          { "index": 17, "name": "cf1:Districts", "type": "string" },                        
                          { "index": 18, "name": "cf1:ProvincialAreas", "type": "string" },                  
                          { "index": 19, "name": "cf1:Address", "type": "string" },                          
                          { "index": 20, "name": "cf1:Business", "type": "string" },                         
                          { "index": 21, "name": "cf1:Income", "type": "string" },                           
                          { "index": 22, "name": "cf1:Conveyance", "type": "string" },                        
                          { "index": 23, "name": "cf1:Wechat", "type": "string" },                           
                          { "index": 24, "name": "cf1:Reference", "type": "string" },                        
                          { "index": 25, "name": "cf1:InviteCode", "type": "string" },                       
                          { "index": 26, "name": "cf1:HobbyList", "type": "string" },                        
                          { "index": 27, "name": "cf1:ThirdCardNo", "type": "string" },                      
                          { "index": 28, "name": "cf1:IsPostal", "type": "string" },                         
                          { "index": 29, "name": "cf1:FocusInfoList", "type": "string" },                    
                          { "index": 30, "name": "cf1:AcceptInfoTypeList", "type": "string" },               
                          { "index": 31, "name": "cf1:ShoppingInterestList", "type": "string" },             
                          { "index": 32, "name": "cf1:ActiveInterestList", "type": "string" },               
                          { "index": 33, "name": "cf1:CarNO", "type": "string" },                             
                          { "index": 34, "name": "cf1:Remark1", "type": "string" },                           
                          { "index": 35, "name": "cf1:Remark2", "type": "string" },                           
                          { "index": 36, "name": "cf1:Remark3", "type": "string" },                           
                          { "index": 37, "name": "cf1:Remark4", "type": "string" },                           
                          { "index": 38, "name": "cf1:Remark5", "type": "string" },                           
                          { "index": 39, "name": "cf1:Remark6", "type": "string" },                           
                          { "index": 40, "name": "cf1:Remark7", "type": "string" },                           
                          { "index": 41, "name": "cf1:Remark8", "type": "string" },                           
                          { "index": 42, "name": "cf1:Remark9", "type": "string" },                           
                          { "index": 43, "name": "cf1:Remark10", "type": "string" },                          
                          { "index": 44, "name": "cf1:Remark11", "type": "string" },                          
                          { "index": 45, "name": "cf1:Remark12", "type": "string" },                          
                          { "index": 46, "name": "cf1:Remark13", "type": "string" },                          
                          { "index": 47, "name": "cf1:Remark14", "type": "string" },                          
                          { "index": 48, "name": "cf1:Remark15", "type": "string" },                          
                          { "index": 49, "name": "cf1:Remark16", "type": "string" },                          
                          { "index": 50, "name": "cf1:Remark17", "type": "string" },                          
                          { "index": 51, "name": "cf1:Remark18", "type": "string" },                          
                          { "index": 52, "name": "cf1:Remark19", "type": "string" },                          
                          { "index": 53, "name": "cf1:Remark20", "type": "string" },                          
                          { "index": 54, "name": "cf1:MemberTagIDList", "type": "string" }, 
                          { "index": 55, "name": "cf1:CreateTime", "type": "string" },                       
                          { "index": 56, "name": "cf1:UpdateTime", "type": "string" },                       
                          { "index": 57, "name": "cf1:Status", "type": "string" }
                        ], 
                        "encoding": "utf-8", 
                        "hbaseConfig": {
                            "hbase.cluster.distributed": "true", 
                            "hbase.rootdir": "hdfs://hadoop000:9000/hbase", 
                            "hbase.zookeeper.quorum": "hadoop000,hadoop004,hadoop005"
                        }, 
                        "mode": "normal", 
                        "rowkeyColumn": [{ "index":0, "type":"string"}], 
                        "table": "user_info",
                        "nullMode": "empty"
                    }
                },
                "transformer": [
                    { "name": "dx_groovy",
                      "parameter": { "code": "SimpleDateFormat sdf = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");
                                              String create_time = sdf.format(record.getColumn(55).asDate());
                                              String update_time = sdf.format(record.getColumn(56).asDate());
                                              record.setColumn(55, new StringColumn(create_time));
                                              record.setColumn(56, new StringColumn(update_time));
                                              return record;",                                            
                                     "extraPackage":[ "import java.text.SimpleDateFormat;" ] 
                                   }                                 
                    }
                ]
            }
        ], 
        "setting": {
            "speed": {
                "channel": 4
            }
        }
    }
}
