
create external table test.yijia_sale_count_input (
shop_name string,
shop_id string,
mallcoo_shop_id  string,
`20170601` int, 
`20170602` int, 
`20170603` int, 
`20170604` int,  
`20170605` int, 
`20170606` int, 
`20170607` int, 
`20170608` int, 
`20170609` int, 
`20170610` int, 
`20170611` int, 
`20170612` int,  
`20170613` int, 
`20170614` int, 
`20170615` int, 
`20170616` int,  
`20170617` int, 
`20170618` int, 
`20170619` int, 
`20170620` int,  
`20170621` int, 
`20170622` int, 
`20170623` int, 
`20170624` int, 
`20170625` int, 
`20170626` int, 
`20170627` int, 
`20170628` int,  
`20170629` int, 
`20170630` int, 
`20170701` int, 
`20170702` int,  
`20170703` int, 
`20170704` int, 
`20170705` int, 
`20170706` int,  
`20170707` int, 
`20170708` int, 
`20170709` int, 
`20170710` int, 
`20170711` int, 
`20170712` int, 
`20170713` int, 
`20170714` int,  
`20170715` int, 
`20170716` int, 
`20170717` int, 
`20170718` int,  
`20170719` int, 
`20170720` int, 
`20170721` int, 
`20170722` int,  
`20170723` int, 
`20170724` int, 
`20170725` int, 
`20170726` int, 
`20170727` int, 
`20170728` int, 
`20170729` int, 
`20170730` int,  
`20170731` int, 
`20170801` int, 
`20170802` int, 
`20170803` int,  
`20170804` int, 
`20170805` int, 
`20170806` int, 
`20170807` int,  
`20170808` int, 
`20170809` int, 
`20170810` int, 
`20170811` int, 
`20170812` int, 
`20170813` int, 
`20170814` int, 
`20170815` int,  
`20170816` int, 
`20170817` int, 
`20170818` int, 
`20170819` int,  
`20170820` int, 
`20170821` int, 
`20170822` int, 
`20170823` int,  
`20170824` int, 
`20170825` int, 
`20170826` int, 
`20170827` int, 
`20170828` int, 
`20170829` int, 
`20170830` int, 
`20170831` int,  
`20170901` int, 
`20170902` int, 
`20170903` int, 
`20170904` int,  
`20170905` int, 
`20170906` int, 
`20170907` int, 
`20170908` int,  
`20170909` int, 
`20170910` int, 
`20170911` int, 
`20170912` int, 
`20170913` int, 
`20170914` int, 
`20170915` int, 
`20170916` int,  
`20170917` int, 
`20170918` int, 
`20170919` int, 
`20170920` int,  
`20170921` int, 
`20170922` int, 
`20170923` int, 
`20170924` int,  
`20170925` int, 
`20170926` int, 
`20170927` int, 
`20170928` int, 
`20170929` int, 
`20170930` int, 
`20171001` int, 
`20171002` int,  
`20171003` int, 
`20171004` int, 
`20171005` int, 
`20171006` int,  
`20171007` int, 
`20171008` int, 
`20171009` int, 
`20171010` int, 
`20171011` int, 
`20171012` int, 
`20171013` int, 
`20171014` int, 
`20171015` int, 
`20171016` int, 
`20171017` int, 
`20171018` int, 
`20171019` int, 
`20171020` int, 
`20171021` int, 
`20171022` int, 
`20171023` int, 
`20171024` int, 
`20171025` int, 
`20171026` int, 
`20171027` int, 
`20171028` int, 
`20171029` int, 
`20171030` int, 
`20171031` int, 
`20171101` int, 
`20171102` int, 
`20171103` int, 
`20171104` int, 
`20171105` int  
)
row format delimited fie,lds terminated by '\t'
location '/user/duyong/yijia';
                 


				 
create table test.yijia_sale_count (
shop_name string,
shop_id string,
mallcoo_shop_id  string,
sale_day string,
sale_count int
)



insert overwrite table test.yijia_sale_count 
select a.shop_name,
       a.shop_id,
       a.mallcoo_shop_id,
       b.key as sale_day,
       b.value as sale_count
  from test.yijia_sale_count_input a 
 lateral view explode(map(
'20170601', `20170601`,
'20170602', `20170602`,
'20170603', `20170603`,
'20170604', `20170604`,
'20170605', `20170605`,
'20170606', `20170606`,
'20170607', `20170607`,
'20170608', `20170608`,
'20170609', `20170609`,
'20170610', `20170610`,
'20170611', `20170611`,
'20170612', `20170612`,
'20170613', `20170613`,
'20170614', `20170614`,
'20170615', `20170615`,
'20170616', `20170616`,
'20170617', `20170617`,
'20170618', `20170618`,
'20170619', `20170619`,
'20170620', `20170620`,
'20170621', `20170621`,
'20170622', `20170622`,
'20170623', `20170623`,
'20170624', `20170624`,
'20170625', `20170625`,
'20170626', `20170626`,
'20170627', `20170627`,
'20170628', `20170628`,
'20170629', `20170629`,
'20170630', `20170630`,
'20170701', `20170701`,
'20170702', `20170702`,
'20170703', `20170703`,
'20170704', `20170704`,
'20170705', `20170705`,
'20170706', `20170706`,
'20170707', `20170707`,
'20170708', `20170708`,
'20170709', `20170709`,
'20170710', `20170710`,
'20170711', `20170711`,
'20170712', `20170712`,
'20170713', `20170713`,
'20170714', `20170714`,
'20170715', `20170715`,
'20170716', `20170716`,
'20170717', `20170717`,
'20170718', `20170718`,
'20170719', `20170719`,
'20170720', `20170720`,
'20170721', `20170721`,
'20170722', `20170722`,
'20170723', `20170723`,
'20170724', `20170724`,
'20170725', `20170725`,
'20170726', `20170726`,
'20170727', `20170727`,
'20170728', `20170728`,
'20170729', `20170729`,
'20170730', `20170730`,
'20170731', `20170731`,
'20170801', `20170801`,
'20170802', `20170802`,
'20170803', `20170803`,
'20170804', `20170804`,
'20170805', `20170805`,
'20170806', `20170806`,
'20170807', `20170807`,
'20170808', `20170808`,
'20170809', `20170809`,
'20170810', `20170810`,
'20170811', `20170811`,
'20170812', `20170812`,
'20170813', `20170813`,
'20170814', `20170814`,
'20170815', `20170815`,
'20170816', `20170816`,
'20170817', `20170817`,
'20170818', `20170818`,
'20170819', `20170819`,
'20170820', `20170820`,
'20170821', `20170821`,
'20170822', `20170822`,
'20170823', `20170823`,
'20170824', `20170824`,
'20170825', `20170825`,
'20170826', `20170826`,
'20170827', `20170827`,
'20170828', `20170828`,
'20170829', `20170829`,
'20170830', `20170830`,
'20170831', `20170831`,
'20170901', `20170901`,
'20170902', `20170902`,
'20170903', `20170903`,
'20170904', `20170904`,
'20170905', `20170905`,
'20170906', `20170906`,
'20170907', `20170907`,
'20170908', `20170908`,
'20170909', `20170909`,
'20170910', `20170910`,
'20170911', `20170911`,
'20170912', `20170912`,
'20170913', `20170913`,
'20170914', `20170914`,
'20170915', `20170915`,
'20170916', `20170916`,
'20170917', `20170917`,
'20170918', `20170918`,
'20170919', `20170919`,
'20170920', `20170920`,
'20170921', `20170921`,
'20170922', `20170922`,
'20170923', `20170923`,
'20170924', `20170924`,
'20170925', `20170925`,
'20170926', `20170926`,
'20170927', `20170927`,
'20170928', `20170928`,
'20170929', `20170929`,
'20170930', `20170930`,
'20171001', `20171001`,
'20171002', `20171002`,
'20171003', `20171003`,
'20171004', `20171004`,
'20171005', `20171005`,
'20171006', `20171006`,
'20171007', `20171007`,
'20171008', `20171008`,
'20171009', `20171009`,
'20171010', `20171010`,
'20171011', `20171011`,
'20171012', `20171012`,
'20171013', `20171013`,
'20171014', `20171014`,
'20171015', `20171015`,
'20171016', `20171016`,
'20171017', `20171017`,
'20171018', `20171018`,
'20171019', `20171019`,
'20171020', `20171020`,
'20171021', `20171021`,
'20171022', `20171022`,
'20171023', `20171023`,
'20171024', `20171024`,
'20171025', `20171025`,
'20171026', `20171026`,
'20171027', `20171027`,
'20171028', `20171028`,
'20171029', `20171029`,
'20171030', `20171030`,
'20171031', `20171031`,
'20171101', `20171101`,
'20171102', `20171102`,
'20171103', `20171103`,
'20171104', `20171104`,
'20171105', `20171105`
 )
 ) b as key, value


